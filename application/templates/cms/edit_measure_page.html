{% extends "base_cms.html" %}
{% block title %}Edit measure{% endblock %}
{% block main_content %}
    <div>
        <a href="{{ url_for('cms.index') }}">Home</a> >
        <a href="{{ url_for('cms.topic_overview', slug=topic.guid) }}">{{ topic.title }}</a> >
        <a href="{{ url_for('cms.subtopic_overview', slug=subtopic.guid) }}">{{ subtopic.title }}</a> >
        <a href="#">{{ measure.title }}</a>
    </div>
    <h2>Edit measure</h2>
    <div class="panel {{ status }}">
        <p>Status: {{ status | format_as_title }}</p>
    </div>
    <div class="edit-form">
        <form method="POST" action="{{ url_for('cms.edit_measure_page', topic=topic.meta.guid, subtopic=subtopic.meta.guid, measure=measure.meta.guid) }}">
            <label for="{{ form.guid.id }}">{{ form.guid.label }}</label>
            {{ form.guid }}
            <h3>Overview</h3>
            <label for="{{ form.title.id }}">{{ form.title.label }}</label>
            {{ form.title }}
            <label for="{{ form.measure_summary.id }}">{{ form.measure_summary.label }}</label>
            {{ form.measure_summary(rows='7',cols='100') }}
            <label for="{{ form.summary.id }}">{{ form.summary.label }}</label>
            {{ form.summary(rows='7',cols='100') }}
            <label for="{{ form.geographic_coverage.id }}">{{ form.geographic_coverage.label }}</label>
            {{ form.geographic_coverage(rows='7',cols='100') }}
            <label for="{{ form.time_covered.id }}">{{ form.time_covered.label }}</label>
            {{ form.time_covered(rows='7',cols='100') }}
            <label for="{{ form.keywords.id }}">{{ form.keywords.label }}</label>
            {{ form.keywords }}
            <h3>Need To Know</h3>
            <label for="{{ form.need_to_know.id }}">{{ form.need_to_know.label }}</label>
            {{ form.need_to_know(rows='7',cols='100') }}
            <label for="{{ form.ethnicity_definition_summary.id }}">{{ form.ethnicity_definition_summary.label }}</label>
            {{ form.ethnicity_definition_summary(rows='7',cols='100') }}
            <label for="{{ form.ethnicity_definition_detail.id }}">{{ form.ethnicity_definition_detail.label }}</label>
            {{ form.ethnicity_definition_detail(rows='7',cols='100') }}
            <label for="{{ form.location_definition_summary.id }}">{{ form.location_definition_summary.label }}</label>
            {{ form.location_definition_summary(rows='7',cols='100') }}
            <label for="{{ form.location_definition_detail.id }}">{{ form.location_definition_detail.label }}</label>
            {{ form.location_definition_detail(rows='7',cols='100') }}
            <h3>Publishing Details</h3>
            <label for="{{ form.source_text.id }}">{{ form.source_text.label }}</label>
            {{ form.source_text(rows='7',cols='100') }}
            <label for="{{ form.source_url.id }}">{{ form.source_url.label }}</label>
            {{ form.source_url }}
            <label for="{{ form.department_source.id }}">{{ form.department_source.label }}</label>
            {{ form.department_source(rows='7',cols='100') }}
            <label for="{{ form.published_date.id }}">{{ form.published_date.label }}</label>
            {{ form.published_date }}
            <label for="{{ form.last_update_date.id }}">{{ form.last_update_date.label }}</label>
            {{ form.last_update_date }}
            <label for="{{ form.revisions.id }}">{{ form.revisions.label }}</label>
            {{ form.revisions }}
            <label for="{{ form.next_update_date.id }}">{{ form.next_update_date.label }}</label>
            {{ form.next_update_date }}
            <label for="{{ form.frequency.id }}">{{ form.frequency.label }}</label>
            {{ form.frequency }}
            <h4>Related Publications (Not implemented yet)</h4>
            <label for="{{ form.contact_name.id }}">{{ form.contact_name.label }}</label>
            {{ form.contact_name }}
            <label for="{{ form.contact_phone.id }}">{{ form.contact_phone.label }}</label>
            {{ form.contact_phone }}
            <label for="{{ form.contact_email.id }}">{{ form.contact_email.label }}</label>
            {{ form.contact_email }}
            <h3>Technical Details</h3>
            <label for="{{ form.methodology.id }}">{{ form.methodology.label }}</label>
            {{ form.methodology(rows='7',cols='100') }}
            <label for="{{ form.data_type.id }}">{{ form.data_type.label }}</label>
            {{ form.data_type(rows='7',cols='100') }}
            <label for="{{ form.population_or_sample.id }}">{{ form.population_or_sample.label }}</label>
            {{ form.population_or_sample(rows='7',cols='100') }}
            <label for="{{ form.disclosure_control.id }}">{{ form.disclosure_control.label }}</label>
            {{ form.disclosure_control(rows='7',cols='100') }}
            <label for="{{ form.estimation.id }}">{{ form.estimation.label }}</label>
            {{ form.estimation(rows='7',cols='100') }}
            <h3>Quality Assurance</h3>
            <label for="{{ form.quality_assurance.id }}">{{ form.quality_assurance.label }}</label>
            {{ form.quality_assurance(rows='7',cols='100') }}
            <label for="{{ form.qmi_text.id }}">{{ form.qmi_text.label }}</label>
            {{ form.qmi_text(rows='7',cols='100') }}
            <label for="{{ form.qmi_url.id }}">{{ form.qmi_url.label }}</label>
            {{ form.qmi_url(rows='7',cols='100') }}


            {#                TODO: Dress up publish button with context #}
            <div class="button-bar">
                <ul class="button-group">
                    {% if "REJECT" in available_actions %}
                        <a class="button info" href="{{ url_for('cms.reject_page', slug=slug)}}">Reject</a>
                    {% endif %}
                </ul>
                 <ul class="button-group button-right">
                    {% if "UPDATE" in available_actions %}
                        <button type="submit" class="button">{%  if status == 'rejected'%}Send back to review{%  else %}Update{%  endif %}</button>
                    {% endif %}
                    {% if  "APPROVE" in available_actions %}
                        <a class="button" href="{{ url_for('cms.publish_page', slug=measure_slug)}}">
                            {{ next_approval_state | format_approve_button }}
                        </a>
                    {% endif %}
                </ul>
            </div>
        </form>
        <p class="preview">
            <a href="{{ url_for('preview.preview_measure', topic=topic_slug, subtopic=subtopic_slug, measure=measure_slug) }}">Preview page</a>
        </p>
     </div>
    </div>
{% endblock %}